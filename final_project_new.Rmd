---
title: "college_basketball"
author: "Will Curkan"
date: "11/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(readxl)
```

```{r import data}
bb_dat = read.csv("CollegeBasketballPlayers2009-2021.csv")
school_dat = read_excel("bb_school_ranks.xlsx")
```

Cleaned data to make easier to work with
```{r data cleanup}
new_bb = bb_dat %>%
  rename(role = X, player = player_name) %>%
  filter(year > 2016) %>%
  select(!ht & !dunksmade & !dunksmiss.dunksmade
         & !dunksmade..dunksmade.dunksmiss.
         & !type & !num & !pid & !pick & !pfr
         & !Rec.Rank)

glimpse(new_bb)

# new_bb %>%
#   filter(is.na())
glimpse(school_dat)
```

Creating a data frame to join with data to filter for top 25 teams in each season
```{r top_25}
# year = [2017:2019]
# teams = 

```

```{r}

new_bb %>% #number of players from each school
  group_by(team) %>%
  summarize(n=n(),
            n_players = n_distinct(player))

#looking at top offensive ratings
new_bb %>%
  filter(team == "Abilene Christian" | team == "Duke") %>%
  arrange(desc(Ortg))

# Duke U twoPOintAttem v percentage
new_bb %>%
  rename(pos = X) %>%
  select(team, pos) %>%
  filter(team == "Duke" & !pos == '') %>%
  group_by(pos) %>%
  summarize(n=n())
  ggplot(aes(x = twoPA,y=twoP_per)) + geom_point() +
  facet_wrap(~year)
  
```

1. Correlation between year (freshman, sophmore, etc) and stats
```{r}
new_bb = filter(team == "Abilene Christian" & yr == "So")
  

```
2. correlation between year played(AD ex: 2014) and points scored
3. Correlation between position and points scored(barplot) group-by(team), facet year
```{r}
bb_dat %>%
  rename(pos = X) %>%
  filter(team == "Duke" | team == "Abilene Christian") %>%
  group_by(pos) %>%
  summarize(pts_scd = sum(FTM,2*twoPM,3*TPM, na.rm = True))

```
4. Correlation between rebounds(offense and def) position, and points scored (continuous)
5.
6. Create a dream team?
