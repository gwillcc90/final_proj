---
title: "college_basketball"
author: "Will Curkan"
date: "11/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages('corrplot')
library(tidyverse)
library(dplyr)
library(GGally)
library(ggplot2)
library(corrplot)
library(RColorBrewer)
library(stringr)
library(readxl)
```

```{r import data}
bb_dat = read.csv("CollegeBasketballPlayers2009-2021.csv")
school_dat = read_excel("bb_school_ranks.xlsx")

```

Cleaned data to make easier to work with:
1. rename variables to readable, workable names
2. filter to recent 3 years
3. remove less-meaningful variables
```{r data cleanup}
new_bb = bb_dat %>%
  rename(role = X, player = player_name) %>%
  filter(year > 2018) %>%
  select(!ht & !dunksmade & !dunksmiss.dunksmade
         & !dunksmade..dunksmade.dunksmiss.
         & !type & !num & !pid & !pick & !pfr
         & !Rec.Rank & !conf)


#rename school to team to match new_bb
new_ranks = school_dat %>%
  rename(team = school)

```

Creating joined frame to work with top 25 ranked schools:
```{r joined}
top_25s = right_join(new_bb,new_ranks) %>%
  relocate(college_year = yr, year, role, .before = GP)

top_25s
#
top_25s %>%
  filter(!college_year == "Sr") %>%
  add_count(player) %>%
  filter(n == 3) %>%
  group_by(player)
```

In order to create a dream team for the 2022 season we must look at freshman in 2018-2019, freshman and sophmores in 2019-2020, and freshman, sophmore, and juniors in 2020-2021
```{r freshman 2019 filters}
#filters for freshman in 2017-2018 season



#top freshman guards
top_fr_guards = top_25s %>%
  filter(college_year == 'Fr' & year == 2019) %>%
  filter(role == "Combo G" | role == "Scoring PG"
        | role == "Wing G" | role == "Pure PG")


#top powerforwards and centers
top_fr_PfC = top_25s %>%
  filter(college_year == 'Fr' & year == 2019) %>%
  filter(role == "PF/C" | role == "C"
        | role == "Wing F" | role == "Stretch 4")



corrplot(cor(top_fr_role_PfC_contdat), type="upper", order="hclust",
         col=brewer.pal(n=8, name="RdYlBu"))

``` 

```{r freshman guards plot}
top_fr_guards %>% 
  select(where(is.double))
  
top_fr_guards %>%
  ggplot(aes(x = twoPA)) +
  geom_histogram()

top_fr_PfC %>%
  ggplot(aes(x = twoPA,y = twoPM)) +
  geom_violin()

top_fr_PfC %>%
  arrange(desc(DRB_per,twoP_per)) %>%
  slice(1:5) %>%
  ggplot(aes(x = DRB_per,y = twoP_per)) +
  geom_point() +
  geom_smooth() + 
  geom_text(aes(label=player))

top_fr_PfC %>%
  arrange(desc(DRB_per,twoP_per)) %>%
  slice(1:5) %>%
  ggplot(aes(x = DRB_per,y = twoP_per)) +
  geom_point() +
  geom_smooth() + 
  geom_text(aes(label=player))


#filter for top DRB percentage and shooting
top_fr_PfC %>%
  arrange(desc(DRB_per,twoP_per)) %>%
  filter(Min_per > 50)
  

```

```{r fresh_soph_2020 filters}
#filters for freshman and sophmores in 2018-2019 season
top_25_2soph_2020 = top_25s %>%
  filter(yr == "Fr" & year == 2020
         | yr == "So" & year == 2020)

#top guards
top_2soph_role_g_2020 = top_25_2soph_2020 %>%
    filter(role == "Combo G" | role == "Scoring PG"
         | role == "Wing G" | role == "Pure PG")

#top powerforwards/center
top_2soph_role_pfC_2020 = top_25_2soph_2020 %>%
      filter(role == "PF/C" | role == "C"
         | role == "Wing F" | role == "Stretch 4")
```

```{r to juniors 2021}
#freshman, sophmore, juniors in 2020-2021 season

#top guards
top_2jnr_guards = top_25s %>%
  filter(!yr == "Sr") %>%
  filter(role == "Combo G" | role == "Scoring PG"
         | role == "Wing G" | role == "Pure PG")

#top powerforwards/center
top_2jnr_PfC = top_25s %>%
  filter(!yr == "Sr") %>%
  filter(role == "PF/C" | role == "C"
         | role == "Wing F" | role == "Stretch 4")


```




1. Correlation between year (freshman, sophmore, etc) and stats
```{r}
```
2. correlation between year played(AD ex: 2014) and points scored


```{r freshman plots}
#looking at freshman playing most games and scoring highest
top_25_fr_2019 %>%
  filter(GP > 20 & Min_per > 50) %>%
  ggplot(aes(x = twoP_per,y = TP_per)) + 
  geom_point() + 
  geom_text(aes(label = player),size = 4,ljust = .25)

top_fr_role_g %>%
  filter(Min_per > 59.9 & AST_per > 20 ) %>%
  ggplot(aes(x = twoP_per,y = TP_per)) + 
  geom_point() + 
  geom_text(aes(label = player),size = 4,ljust = .25)

```

```
3. Correlation between position and points scored(barplot) group-by(team), facet year
4. Correlation between rebounds(offense and def) position, and points scored (continuous)
5. Look at averages for all players and see which freshman stick out
6. filter players not appearing in latter years
7. Look at who improves throughout the years
filter for players who only play to junior year

